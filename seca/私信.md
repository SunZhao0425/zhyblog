## 私信

1. app 启动调用
/app/msglog/getTotalNotReadV1   

-> /system-message/get-all-count


私信

1. 关注的人
2. 未关注的人
3. 黑名单



39.106.102.182:5536


prvmsg/138214


a.app登陆时，通过新增php接口，固定取redis值，下行长连接地址。  (和谢老师确定一个redis 的key值 ) 解决
b.新增pc端发信和读信需要处理，保持原来的pc没有长连接不需要红点。 ( )
c.登陆哪里请求老接口php统计(3+1)个分类未读数，当长连接收到私信有新消息，再次请求老接口。
d.发私信时，在发成功IM后，改为php接口方便pc+2端同时通用，通知node服务器。
e.读私信时，每次请求php接口，通知node服务器。
f.删除(清空)私信，每次请求php接口，通知node服务器。

g.历史私信处理，如何过渡期？【用php，登陆时只拉取一次，通知node】
h.群发信息的处理？


新增两个接口 一个读私信接口 一个发私信接口


(获取redis中该用户的私信数)

c.登陆时，请求老php接口(最开始就有)统计(3+1，1为【新增】私信数，redis获取)个分类未读数  
d.当长连接收到私信有新消息，两端再次请求老php接口一次获取最新的(3+1，1为【新增】私信数，redis获取)未读数。

(发送私信 , 新增)

e.发私信时，在发成功IM后，【增加】php接口(之前方案是直接node通知客户端)方便pc+2端同时通用，操作reids，同时代码通知node服务器，node服务区器通过长连接告诉对方。


f.读私信时，【增加】php接口，操作redis。

g.删除(清空)私信，【增加】请求php接口，操作redis。


h.历史私信处理，如何过渡期？【用php，登陆时根据setbit只拉取一次，操作redis】

i.群发信息的处理？

redis设计
1.有一个setbit类型的key，存放用户是否拉取过im到node服务器
2.以用户id为key的set类型im消息ID集合。可以进行增加(发)、删除(读)、销毁(清空)操作
3.a.c.e.f.g php直接操作redis。



//用于Redis BIT类型存储的格式为二进制,销毁的内存和进程非常低,适用于统计某项数据的打开与关闭
//使用场景一：用户签到
//使用场景二：统计活跃用户
//使用场景三：用户在线状态


/comment/f-praise?subjectId=973447&businessId=2000&commentId=282679&statistics=android%7Csecalive-baidu%7C1.0%7Ced4f6eb73c954e88%7C5.1%7C862586039230417%7C4G%7C5.2.0%7C&token=b73342931e47149ffa58becf8f5fbf88*5546663


  
        //私信地址
        'nodemsgurl'=>
            [
                'master'=>[
                    'host'=>'172.16.10.101',
                    'port'=>'6379',
                    'password'=>'nNNsMFtpEbZpLEcVYjput7yanUUZfr5u',
                    'timeout'=>'3'
                ],
                'slaves'=>[
                    [
                        'host'=>'172.16.10.101',
                        'port'=>'6379',
                        'password'=>'nNNsMFtpEbZpLEcVYjput7yanUUZfr5u',
                        'timeout'=>'3'
                    ],
                ],
            ]



              //node server
    'nodeServer'=>[
        'socketIp'=>'192.168.2.13', //聊天默认服务器ip
        //红包使用的默认ip
        'redbagdefaultIp'=>'192.168.2.13', //是一台服务器
        'nodeHttpIp'=>'192.168.2.13',
        'esHttpIp'=>'192.168.2.13',//consumelogEsNode
        'socketMsgIp'=> '39.106.102.182' // 私信服务器Ip
    ],


    app 启动获取配置项 (nodeMsgUrl)
    http://192.168.2.248:3000/project/10/interface/api/855

    私信未读数(首页小红点)
    http://192.168.2.248:3000/project/13/interface/api/3248

    发私信
    http://192.168.2.248:3000/project/10/interface/api/3221

    读私信
    http://192.168.2.248:3000/project/10/interface/api/3230

    清空
    http://192.168.2.248:3000/project/10/interface/api/3239


北京朝阳区高碑店西店610号自创空间CBD写字园B1 

Wiki >> 研发部面试及流程
一试：研发部面试流程--PHP开发工程师

个人基本情况
自我介绍
询问现住址，上班到公司的时间，当前距离是否能接受
哪里人，是否在北京，是否需要防疫检查？
询问上一家公司的情况，什么行业的【互联网/软件/金融/教育/电商等】，具体做那块业务；
【自研项目】/【外派公司】
整个工作经验是几年？
上一家公司，待了多久？ 为什么离职？
开发人员结构：前端(安卓/苹果/前端)几个人，后端几个人，前后端比例情况【1:1/1:2】，开发测试比【4:1】，产研比等；
开发沟通方式：产品是几个人，和产品经理如何沟通？
开发沟通方式：项目经理情况，和项目经理如何沟通？
编辑此区域
理论知识
网络知识 http,tcp
操作系统知识 进程，线程
算法
数据结构
设计模式
代码规范，PSR
编辑此区域
工具应用
PHP 基础语法,框架，框架源码，PHP源码
Nginx php与nginx通信，nginx基础配置，优化配置
MySQL curd,索引，事务，底层数据结构，主从，分库分表
Redis 基础数据类型，底层结构与优化
ElasticSearch
Composer
Linux
其他技术
编辑此区域
项目经验
商业项目 行业 如电商，解决方案
开源项目 github
编辑此区域
学习方式编辑此区域
未来规划

公司介绍
盛力世家是一家主要致力于体育与娱乐方面的发展，体育营销顾问，体育策划，运动人才开发以及激活营销服务的生活方式推广公司。

中国体育是盛力世家旗下的体育媒体平台。主要以赛事直播，版权集中在乒乓球，羽毛球，台球（斯洛克，中式8球，九球），自行车（环法，环西），拳击，障碍赛跑（斯巴达）等。

产品包括：PC端，移动端APP，TV端，PAD端，HTML5，以及相关PC软件等。

技术产研团队50人左右。包括架构师，后台工程师10多人；移动端开发工程师也是10多人，还包括QA，运维等团队。




首先做个简单个自我介绍。
您工作经验几年？上一家公司，待了多久？上一家公司，为什么离职？
最有技术难度的项目，介绍项目中的相关设计方法，及实现流程；以及在团队中的位置（负责人：是/否）；
程序岗位 ：该问题比较合适；
测试职位 ：该问题调整为偏向有挑战的方向；
项目岗位 ：该问题调整为偏重流程方向；
如果工作中遇到技术瓶颈，你的解决思路是什么？
百度/学习/网课/询问
在讲求原则和沟通协调之间，你会做什么选择？你生活或者工作中坚持最长的一件事情是什么？
个人是否有强迫症？是否有拖延的习惯？是否有收集整理的习惯？你性格中有什么优缺点？哪个星座？
固执
兴趣爱好有什么？
喜欢体育项目；
关注视频网站：90后A站，B站；腾讯视频，爱奇艺，抖音；快手；
人生理想，近期的职业规划。
自己本专业内有什么新的技术方向？
薪资要求是多少？
*是否从青岛返京，是否隔离期结束？
学校是否全日制/民办学校？需要向HR报备
上一家公司社保基数是否全额，薪资是否有避税动作？需要向HR报备
薪资构成试用期6个月，试用期80%薪水，试用期内研发部3次考评（第2周结束，第1个月结束，第2个月结束，第3个月结束），试用期结束后，80%基本薪资，20%绩效薪资。


